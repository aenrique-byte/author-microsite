RewriteEngine On

# Handle Angular and React Router
RewriteBase /

# Sitemap
RewriteRule ^sitemap\.xml$ /api/sitemap.xml.php [L]

# Handle API requests - don't rewrite these
RewriteRule ^api/ - [L]

# Handle static files - don't rewrite these
RewriteRule ^(assets|images|icon|prerender)/ - [L]

# Don't rewrite actual files (JS, CSS, images, etc.)
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule . - [L]

# Bot detection for all other routes - route through PHP
# This serves pre-rendered HTML to bots, React SPA to users
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /bot-entry.php [L]
